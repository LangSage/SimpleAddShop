{% extends 'blog/base.html' %}

{% block title %}
    {{ post.title }} | SimpleAdd
{% endblock %}

{% block content %}


<div class="container mt-4">
    <div class="row">
        <!-- Main Content -->
        <div class="col-lg-8 col-md-12 mb-4">
            <article class="post-detail">
                <h1 class="post-title">{{ post.title }}</h1>
                <p class="post-meta">Опубликовано: {{ post.published_date }}</p>

                {% if post.image %}
                <img src="{{ post.image.url }}" class="img-fluid post-image" style="width:100%;max-height:500px;object-fit:cover;border-radius:10px;" alt="{{ post.title }}">
                {% endif %}

                <div class="post-content">
                    {{ post.content|linebreaks }}
                </div>
            </article>
        </div>

        <!-- Related Products Sidebar -->
        <div class="col-lg-4 col-md-12">
            <aside class="related-products-sidebar">
                <div class="card mb-4 shadow-sm">
                    <div class="card-header bg-primary text-white">
                        <h4 class="mb-0">Связанные товары</h4>
                    </div>
                    <div class="card-body">
                        {% if post.products.all %}
                            <div class="related-products">
                                {% for product in post.products.all %}
                                    <div class="product-item d-flex mb-3">
                                        {% if product.image %}
                                            <img src="{{ product.image.url }}" class="product-image rounded me-3" alt="{{ product.name }}">
                                        {% endif %}
                                        <div>
                                            <h5 class="product-title">{{ product.name }}</h5>
                                            <p class="product-description mb-2">{{ product.description|slice:":80" }}...</p>
                                            <a href="{% url 'product_detail' product.id %}" class="btn btn-outline-primary btn-sm">Посмотреть товар</a>
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        {% else %}
                            <p class="text-muted">Нет связанных товаров.</p>
                        {% endif %}
                    </div>
                </div>
            </aside>
        </div>
    </div>

    <!-- Random Posts Section -->
<div class="random-posts mt-5">
    <h4 class="mb-4 text-primary text-uppercase border-bottom pb-2">Читать далее:</h4>
    <div class="row">
        {% for post in posts %}
            <div class="col-sm-12 col-md-6 col-lg-4 mb-4">
                <div class="related-post-item card shadow-sm rounded overflow-hidden h-100">
                    <a href="{% url 'post_detail' post.id %}" class="text-decoration-none text-dark d-flex flex-column h-100">
                        {% if post.image %}
                            <div class="related-post-image-wrapper">
                                <img src="{{ post.image.url }}" class="related-post-image" style="width:100%;height:200px;object-fit:cover;" alt="{{ post.title }}">
                            </div>
                        {% endif %}
                        <div class="related-post-body p-3 d-flex flex-column justify-content-between flex-grow-1">
                            <p class="related-post-title fw-bold mb-3">{{ post.title }}</p>
                            <span class="btn btn-outline-primary mt-auto align-self-start">Читать далее</span>
                        </div>
                    </a>
                </div>
            </div>
        {% empty %}
            <p>Нет доступных постов для чтения.</p>
        {% endfor %}
    </div>
</div>





</div>
{% endblock %}
